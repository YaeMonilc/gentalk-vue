{"version":3,"file":"js/430.65ea9371.js","mappings":"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","sources":["webpack://gentalk-vue/./src/views/TalkView/TalkView.vue","webpack://gentalk-vue/./src/views/TalkView/TalkView.js","webpack://gentalk-vue/src/views/TalkView/TalkView.vue","webpack://gentalk-vue/./src/views/TalkView/TalkView.vue?4f14","webpack://gentalk-vue/./src/views/TalkView/TalkView.vue?c0f5"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"talk opacity\"},[_c('div',{staticClass:\"talk-MessageList\"},[_c('transition-group',{attrs:{\"name\":\"messageAnime\"}},_vm._l((_vm.messages),function(message,index){return _c('div',{key:index},[(_vm.listShow(message,index))?_c('div',{staticClass:\"talk-MessageItem\"},[_c('img',{staticClass:\"talk-Avatar\",attrs:{\"src\":require(\"@/assets/m.jpg\")}}),_c('div',{staticClass:\"talk-Information\"},[_c('div',{staticClass:\"talk-Status\"},[_c('p',{staticClass:\"talk-UserName\",domProps:{\"innerHTML\":_vm._s(message.name)}},[_vm._v(\"ÂêçÁß∞\")])]),_c('div',{staticClass:\"talk-Message\"},[_c('span',{staticClass:\"talk-Content\",domProps:{\"innerHTML\":_vm._s(message.text)}},[_vm._v(\"TEST\")])])])]):_vm._e(),(!_vm.listShow(message,index))?_c('div',{staticClass:\"talk-MessageItem-Lines\"},[_c('div',{staticClass:\"talk-Information-Lines\"},[_c('div',{staticClass:\"talk-Message talk-Message-Lines\"},[_c('span',{staticClass:\"talk-Content\",domProps:{\"innerHTML\":_vm._s(message.text)}},[_vm._v(\"TEST\")])])])]):_vm._e()])}),0)],1),_c('div',{staticClass:\"talk-SendMessageLayout pan-up\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sendTextValue),expression:\"sendTextValue\"}],staticClass:\"talk-MessageTextInput gt-textInput\",attrs:{\"type\":\"text\",\"placeholder\":\"ËæìÂÖ•‰Ω†ÊÉ≥ÂèëÁöÑÂÜÖÂÆπ(ÊîØÊåÅHTML)\"},domProps:{\"value\":(_vm.sendTextValue)},on:{\"input\":[function($event){if($event.target.composing)return;_vm.sendTextValue=$event.target.value},_vm.messageTextInputChange]}}),_c('button',{staticClass:\"talk-SendButton gt-button mdui-ripple\",attrs:{\"id\":\"sendMessage\"},on:{\"click\":_vm.sendMessageClick}},[_vm._v(\"üëÜÂèëÈÄÅüëÜ\")])]),_c('button',{staticClass:\"talk-ScrollHeightButton gt-button mdui-ripple\",attrs:{\"id\":\"talk-ScrollHeightButton\"},on:{\"click\":_vm.scrollToBottom}},[_vm._v(\"‚Üì\")])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import $ from 'jquery'\r\nimport Cookies from \"js-cookie\";\r\nlet Base64 = require('js-base64').Base64\r\n\r\nexport default {\r\n    name: 'talk',\r\n    data:function(){\r\n        return {\r\n            messages:[\r\n                {\r\n                    \"account\":\"È¥µA\",\r\n                    \"name\":\"114514\",\r\n                    \"text\":\"<img src='https://iw233.cn/api.php?sort=random'>\"\r\n                },\r\n                {\r\n                    \"account\":\"È¥µB\",\r\n                    \"name\":\"114514\",\r\n                    \"text\":\"ÊàëÂäù‰Ω†Âà´ÊäìËÄóÂ≠ê\"\r\n                },\r\n                {\r\n                    \"account\":\"È¥µB\",\r\n                    \"name\":\"114514\",\r\n                    \"text\":\"‰Ω†Áúã‰Ω†üêéÂë¢\"\r\n                },\r\n            ],\r\n            sendTextValue: \"\",\r\n            stats: 0\r\n        }\r\n    },\r\n    methods:{\r\n        listShow : function (message,index) {\r\n            if (index === 0)\r\n                return true;\r\n            return !(this.messages[index - 1].account === message.account)\r\n        },\r\n        messageTextInputChange : function () {\r\n            const sendButton = $('#sendMessage');\r\n            if (this.sendTextValue.length > 0){\r\n                sendButton.fadeIn(350)\r\n            }else {\r\n                sendButton.fadeOut(350)\r\n            }\r\n        },\r\n        sendMessageClick : function () {\r\n            this.sendMessage({\r\n                \"event\": \"message\",\r\n                \"text\": Base64.encode(this.sendTextValue)\r\n            })\r\n            this.sendTextValue = \"\"\r\n            this.scrollToBottom(200)\r\n        },\r\n        sendMessage : function (json) {\r\n            this.$global.ws.send(Base64.encode(JSON.stringify(json)))\r\n        },\r\n        heartbeat : function () {\r\n            if(this.stats === 0){\r\n                this.sendMessage({\r\n                    \"event\": \"heartbeat\"\r\n                })\r\n            }\r\n        },\r\n        scrollToBottom : function (time) {\r\n            const list = $(\".talk-MessageList\").get(0)\r\n            $(\".talk-MessageList\").animate({\r\n                scrollTop: list.scrollHeight\r\n            }, time);\r\n        },\r\n        scrollToBottomAuto : function (){\r\n            const list = $(\".talk-MessageList\").get(0)\r\n            const scrollTop = parseInt(list.scrollTop)\r\n            const scrollHeight = parseInt(list.scrollHeight)\r\n            const offsetHeight = parseInt(list.offsetHeight)\r\n            if (((scrollHeight - offsetHeight) - scrollTop) < (26 * 3)){\r\n                this.scrollToBottom(200)\r\n            }\r\n        },\r\n        backLoginView : function(){\r\n            this.$global.ws.close()\r\n            this.$router.push(\"/\")\r\n        }\r\n    },\r\n    mounted:function(){\r\n\r\n        const _this = this\r\n\r\n        $('#sendMessage').fadeOut()\r\n        $('#talk-ScrollHeightButton').hide()\r\n\r\n        $(\".talk-MessageList\").scroll(function () {\r\n            const list = $(\".talk-MessageList\").get(0)\r\n            const scrollHeightButton = $(\"#talk-ScrollHeightButton\")\r\n            const scrollTop = parseInt(list.scrollTop)\r\n            const scrollHeight = parseInt(list.scrollHeight)\r\n            const offsetHeight = parseInt(list.offsetHeight)\r\n            if (((scrollHeight - offsetHeight) - scrollTop) > (26 * 6)){\r\n                scrollHeightButton.show(150)\r\n            }else {\r\n                scrollHeightButton.hide(150)\r\n            }\r\n        })\r\n\r\n        /* WebSocket */\r\n        this.$global.ws = new WebSocket(this.$global.wsHead + this.$global.serverUrl + \"/room/\" + Cookies.get(\"token\"))\r\n\r\n        this.$global.ws.onconnect = function () {//heartbeat\r\n        }\r\n\r\n        setInterval(function () {\r\n            _this.heartbeat()\r\n        },5000)\r\n\r\n        this.$global.ws.onmessage = function (message) {\r\n            const serverMessage = Base64.decode(message.data);\r\n            switch (serverMessage){\r\n                case \"TokenCheckFailed\":\r\n                    _this.stats = 301\r\n                    break\r\n                case \"Prohibit\":\r\n                    _this.stats = 302\r\n                    break\r\n                case \"Times\":\r\n                    break\r\n                default:\r\n                    var json = JSON.parse(serverMessage);\r\n                    switch (json.event){\r\n                        case \"ServerElsewhereLink\":\r\n                            _this.stats = 303\r\n                            break\r\n                        case \"HandleMessage\":\r\n                            var handleMessage = json\r\n                            //handleMessage.text = Base64.decode(handleMessage.text)\r\n                            _this.messages.push(handleMessage)\r\n                            _this.scrollToBottomAuto()\r\n                    }\r\n                    break\r\n            }\r\n        }\r\n        \r\n        this.$global.ws.onclose = function () {\r\n            switch (_this.stats){\r\n                case 301:\r\n                    alert(\"TokenÊ†°È™åÂ§±Ë¥•\")\r\n                    break\r\n                case 302:\r\n                    alert(\"Á¶ÅÊ≠¢\")\r\n                    break\r\n                case 303:\r\n                    alert(\"Ë¥¶Âè∑Âú®Âà´Â§ÑÁôªÂΩï\")\r\n                    break\r\n                default:\r\n                    _this.stats = -1\r\n                    alert(\"‰∏éÊúçÂä°Âô®Êñ≠ÂºÄËøûÊé•\")\r\n                    break\r\n            }\r\n            Cookies.set(\"token\",\"\")\r\n            _this.backLoginView()\r\n        }\r\n        \r\n    }\r\n}","<template>\r\n  <div class=\"talk opacity\">\r\n    <div class=\"talk-MessageList\">\r\n      <transition-group name=\"messageAnime\">\r\n        <div :key=\"index\" v-for=\"(message,index) in messages\">\r\n          <div v-if=\"listShow(message,index)\" class=\"talk-MessageItem\">\r\n            <img class=\"talk-Avatar\" src=\"@/assets/m.jpg\">\r\n            <div class=\"talk-Information\">\r\n              <div class=\"talk-Status\">\r\n                <p class=\"talk-UserName\" v-html=\"message.name\">ÂêçÁß∞</p>\r\n              </div>\r\n              <div class=\"talk-Message\">\r\n                <span class=\"talk-Content\" v-html=\"message.text\">TEST</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"!listShow(message,index)\" class=\"talk-MessageItem-Lines\">\r\n            <div class=\"talk-Information-Lines\">\r\n              <div class=\"talk-Message talk-Message-Lines\">\r\n                <span class=\"talk-Content\" v-html=\"message.text\">TEST</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </transition-group>\r\n    </div>\r\n    <div class=\"talk-SendMessageLayout pan-up\">\r\n      <input @input=\"messageTextInputChange\" v-model=\"sendTextValue\" class=\"talk-MessageTextInput gt-textInput\" type=\"text\" placeholder=\"ËæìÂÖ•‰Ω†ÊÉ≥ÂèëÁöÑÂÜÖÂÆπ(ÊîØÊåÅHTML)\" />\r\n      <button id=\"sendMessage\" @click=\"sendMessageClick\" class=\"talk-SendButton gt-button mdui-ripple\">üëÜÂèëÈÄÅüëÜ</button>\r\n    </div>\r\n    <button id=\"talk-ScrollHeightButton\" @click=\"scrollToBottom\" class=\"talk-ScrollHeightButton gt-button mdui-ripple\">‚Üì</button>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n  @import \"@/views/TalkView/TalkView.css\";\r\n</style>\r\n\r\n<style scoped>\r\n  @import \"@/views/TalkView/TalkViewDesktop.css\";\r\n</style>\r\n\r\n<style scoped>\r\n  @import \"@/views/TalkView/TalkViewMobile.css\";\r\n</style>\r\n\r\n<style scoped>\r\n  @import \"@/views/TalkView/MessageHtmlTag.css\";\r\n</style>\r\n\r\n<script>\r\nimport talk from \"@/views/TalkView/TalkView\";\r\nexport default talk;\r\n</script>\r\n\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TalkView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./TalkView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TalkView.vue?vue&type=template&id=d70caf68&scoped=true&\"\nimport script from \"./TalkView.vue?vue&type=script&lang=js&\"\nexport * from \"./TalkView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TalkView.vue?vue&type=style&index=0&id=d70caf68&prod&scoped=true&lang=css&\"\nimport style1 from \"./TalkView.vue?vue&type=style&index=1&id=d70caf68&prod&scoped=true&lang=css&\"\nimport style2 from \"./TalkView.vue?vue&type=style&index=2&id=d70caf68&prod&scoped=true&lang=css&\"\nimport style3 from \"./TalkView.vue?vue&type=style&index=3&id=d70caf68&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d70caf68\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_setupProxy","staticClass","attrs","_l","messages","message","index","key","listShow","require","domProps","_s","name","_v","text","_e","directives","rawName","value","sendTextValue","expression","on","$event","target","composing","messageTextInputChange","sendMessageClick","scrollToBottom","staticRenderFns","Base64","data","stats","methods","account","sendButton","$","length","fadeIn","fadeOut","sendMessage","encode","json","$global","ws","send","JSON","stringify","heartbeat","time","list","get","animate","scrollTop","scrollHeight","scrollToBottomAuto","parseInt","offsetHeight","backLoginView","close","$router","push","mounted","_this","hide","scroll","scrollHeightButton","show","WebSocket","wsHead","serverUrl","Cookies","onconnect","setInterval","onmessage","serverMessage","decode","parse","event","handleMessage","onclose","alert","component"],"sourceRoot":""}